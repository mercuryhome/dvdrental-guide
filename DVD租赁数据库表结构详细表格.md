# DVD 租赁数据库表结构详细表格

## 概述

本文档以表格形式详细描述了 DVD 租赁数据库的所有表结构，包括字段定义、数据类型、约束条件、索引设计等信息。

## 表结构详细说明

### 1. 人员相关表

#### 1.1 customer（客户表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| customer_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 客户唯一标识，主键 | 系统自动生成的客户ID |
| store_id | SMALLINT | - | - | ✓ | ✓ | - | 所属店铺ID，外键引用store表 | 客户注册的店铺 |
| first_name | VARCHAR | 45 | - | - | ✓ | - | 客户名字 | 客户的名字 |
| last_name | VARCHAR | 45 | - | - | ✓ | - | 客户姓氏 | 客户的姓氏 |
| email | VARCHAR | 50 | - | - | - | - | 客户邮箱地址 | 客户联系邮箱 |
| address_id | SMALLINT | - | - | ✓ | ✓ | - | 地址ID，外键引用address表 | 客户居住地址 |
| activebool | BOOLEAN | - | - | - | ✓ | true | 是否活跃客户 | 客户账户是否激活 |
| create_date | DATE | - | - | - | ✓ | CURRENT_DATE | 客户创建日期 | 客户注册日期 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |
| active | INTEGER | - | - | - | - | - | 活跃状态（0或1） | 客户活跃状态标识 |

**表说明**：存储客户的基本信息，包括姓名、联系方式、地址等。每个客户属于一个店铺，有唯一的地址信息。

#### 1.2 staff（员工表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| staff_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 员工唯一标识，主键 | 系统自动生成的员工ID |
| first_name | VARCHAR | 45 | - | - | ✓ | - | 员工名字 | 员工的名字 |
| last_name | VARCHAR | 45 | - | - | ✓ | - | 员工姓氏 | 员工的姓氏 |
| address_id | SMALLINT | - | - | ✓ | ✓ | - | 地址ID，外键引用address表 | 员工居住地址 |
| email | VARCHAR | 50 | - | - | - | - | 员工邮箱地址 | 员工联系邮箱 |
| store_id | SMALLINT | - | - | ✓ | ✓ | - | 所属店铺ID，外键引用store表 | 员工工作的店铺 |
| active | BOOLEAN | - | - | - | ✓ | true | 是否在职员工 | 员工是否在职 |
| username | VARCHAR | 16 | - | - | ✓ | - | 登录用户名 | 系统登录用户名 |
| password | VARCHAR | 40 | - | - | - | - | 登录密码（加密存储） | 系统登录密码 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |
| picture | BYTEA | - | - | - | - | - | 员工头像图片（二进制数据） | 员工头像照片 |

**表说明**：存储员工的基本信息，包括姓名、联系方式、登录凭据等。员工属于特定店铺，可以处理租赁和支付业务。

#### 1.3 actor（演员表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| actor_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 演员唯一标识，主键 | 系统自动生成的演员ID |
| first_name | VARCHAR | 45 | - | - | ✓ | - | 演员名字 | 演员的名字 |
| last_name | VARCHAR | 45 | - | - | ✓ | - | 演员姓氏 | 演员的姓氏 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：存储演员的基本信息，通过film_actor表与电影建立多对多关系。

### 2. 内容相关表

#### 2.1 film（电影表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| film_id | SERIAL | - | ✓ | - | ✓ | SERIAL | 电影唯一标识，主键 | 系统自动生成的电影ID |
| title | VARCHAR | 255 | - | - | ✓ | - | 电影标题 | 电影的标题名称 |
| description | TEXT | - | - | - | - | - | 电影描述 | 电影的详细描述 |
| release_year | YEAR | - | - | - | - | - | 电影发行年份 | 电影发行的年份（YEAR类型） |
| language_id | SMALLINT | - | - | ✓ | ✓ | - | 语言ID，外键引用language表 | 电影的主要语言 |
| rental_duration | SMALLINT | - | - | - | ✓ | 3 | 租赁时长（天数） | 默认租赁天数 |
| rental_rate | NUMERIC | 4,2 | - | - | ✓ | 4.99 | 租赁费率（美元） | 租赁价格 |
| length | SMALLINT | - | - | - | - | - | 电影时长（分钟） | 电影播放时长 |
| replacement_cost | NUMERIC | 5,2 | - | - | ✓ | 19.99 | 替换成本（美元） | 电影丢失时的赔偿金额 |
| rating | MPAA_RATING | - | - | - | - | G | 电影评级（G,PG,PG-13,R,NC-17） | 电影内容评级，默认G |
| last_update | TIMESTAMP | - | - | - | ✓ | now() | 最后更新时间 | 记录最后修改时间 |
| special_features | TEXT[] | - | - | - | - | - | 特殊功能数组（导演评论、删除场景等） | 电影特殊功能列表 |
| fulltext | TSVECTOR | - | - | - | ✓ | - | 全文搜索向量 | 用于电影标题和描述的全文搜索 |

**表说明**：存储电影的核心信息，包括标题、描述、发行信息、租赁政策等。是系统的核心业务实体。

#### 2.2 category（分类表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| category_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 分类唯一标识，主键 | 系统自动生成的分类ID |
| name | VARCHAR | 25 | - | - | ✓ | - | 分类名称（动作、喜剧、剧情等） | 电影分类名称 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：存储电影分类信息，通过film_category表与电影建立多对多关系。

#### 2.3 language（语言表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| language_id | SERIAL | - | ✓ | - | ✓ | SERIAL | 语言唯一标识，主键 | 系统自动生成的语言ID |
| name | CHARACTER | 20 | - | - | ✓ | - | 语言名称（英语、中文、法语等） | 语言名称 |
| last_update | TIMESTAMP | - | - | - | ✓ | now() | 最后更新时间 | 记录最后修改时间 |

**表说明**：存储语言信息，支持多语言电影管理。

### 3. 业务相关表

#### 3.1 store（店铺表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| store_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 店铺唯一标识，主键 | 系统自动生成的店铺ID |
| manager_staff_id | SMALLINT | - | - | ✓ | ✓ | - | 经理员工ID，外键引用staff表 | 店铺经理的员工ID |
| address_id | SMALLINT | - | - | ✓ | ✓ | - | 地址ID，外键引用address表 | 店铺地址 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：存储店铺信息，每个店铺有一个经理，支持多店铺连锁经营。

#### 3.2 inventory（库存表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| inventory_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 库存唯一标识，主键 | 系统自动生成的库存ID |
| film_id | SMALLINT | - | - | ✓ | ✓ | - | 电影ID，外键引用film表 | 库存中的电影 |
| store_id | SMALLINT | - | - | ✓ | ✓ | - | 店铺ID，外键引用store表 | 库存所在的店铺 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：记录每部电影在各个店铺的库存情况，支持库存查询和管理。

#### 3.3 rental（租赁表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| rental_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 租赁唯一标识，主键 | 系统自动生成的租赁ID |
| rental_date | TIMESTAMP | - | - | - | ✓ | - | 租赁日期时间 | 客户租赁电影的时间 |
| inventory_id | INTEGER | - | - | ✓ | ✓ | - | 库存ID，外键引用inventory表 | 被租赁的库存项 |
| customer_id | SMALLINT | - | - | ✓ | ✓ | - | 客户ID，外键引用customer表 | 租赁的客户 |
| return_date | TIMESTAMP | - | - | - | - | - | 归还日期时间（NULL表示未归还） | 客户归还电影的时间 |
| staff_id | SMALLINT | - | - | ✓ | ✓ | - | 员工ID，外键引用staff表 | 处理租赁的员工 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：记录完整的租赁生命周期，包括租赁时间、归还时间、相关人员和库存信息。

#### 3.4 payment（支付表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| payment_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 支付唯一标识，主键 | 系统自动生成的支付ID |
| customer_id | SMALLINT | - | - | ✓ | ✓ | - | 客户ID，外键引用customer表 | 支付的客户 |
| staff_id | SMALLINT | - | - | ✓ | ✓ | - | 员工ID，外键引用staff表 | 处理支付的员工 |
| rental_id | INTEGER | - | - | ✓ | ✓ | - | 租赁ID，外键引用rental表 | 对应的租赁记录 |
| amount | NUMERIC | 5,2 | - | - | ✓ | - | 支付金额（美元） | 支付的具体金额 |
| payment_date | TIMESTAMP | - | - | - | ✓ | - | 支付日期时间 | 支付发生的时间 |

**表说明**：记录所有支付交易，支持分期支付，与租赁记录关联。

### 4. 地址相关表

#### 4.1 address（地址表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| address_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 地址唯一标识，主键 | 系统自动生成的地址ID |
| address | VARCHAR | 50 | - | - | ✓ | - | 街道地址 | 详细街道地址 |
| address2 | VARCHAR | 50 | - | - | - | - | 详细地址（可选） | 补充地址信息 |
| district | VARCHAR | 20 | - | - | ✓ | - | 区域/区县 | 所属区域或区县 |
| city_id | SMALLINT | - | - | ✓ | ✓ | - | 城市ID，外键引用city表 | 所属城市 |
| postal_code | VARCHAR | 10 | - | - | - | - | 邮政编码 | 地址的邮政编码 |
| phone | VARCHAR | 20 | - | - | ✓ | - | 电话号码 | 地址关联的电话号码 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：存储详细地址信息，被客户、员工、店铺共享使用，支持国际地址格式。

#### 4.2 city（城市表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| city_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 城市唯一标识，主键 | 系统自动生成的城市ID |
| city | VARCHAR | 50 | - | - | ✓ | - | 城市名称 | 城市名称 |
| country_id | SMALLINT | - | - | ✓ | ✓ | - | 国家ID，外键引用country表 | 所属国家 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：存储城市信息，支持全球城市管理，与地址表形成层级关系。

#### 4.3 country（国家表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| country_id | INTEGER | - | ✓ | - | ✓ | SERIAL | 国家唯一标识，主键 | 系统自动生成的国家ID |
| country | VARCHAR | 50 | - | - | ✓ | - | 国家名称 | 国家名称 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：存储国家信息，支持国际化业务，与城市表形成层级关系。

### 5. 关联表

#### 5.1 film_actor（电影演员关联表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| actor_id | SMALLINT | - | ✓ | ✓ | ✓ | - | 演员ID，外键引用actor表，复合主键 | 参演的演员 |
| film_id | SMALLINT | - | ✓ | ✓ | ✓ | - | 电影ID，外键引用film表，复合主键 | 演员参演的电影 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：实现电影与演员的多对多关系，一个演员可以参演多部电影，一部电影可以有多个演员。

#### 5.2 film_category（电影分类关联表）

| 字段名 | 数据类型 | 长度/精度 | 是否主键 | 是否外键 | 是否非空 | 默认值 | 字段注释 | 业务含义 |
|--------|----------|-----------|----------|----------|----------|--------|----------|----------|
| film_id | SMALLINT | - | ✓ | ✓ | ✓ | - | 电影ID，外键引用film表，复合主键 | 被分类的电影 |
| category_id | SMALLINT | - | ✓ | ✓ | ✓ | - | 分类ID，外键引用category表，复合主键 | 电影所属的分类 |
| last_update | TIMESTAMP | - | - | - | ✓ | CURRENT_TIMESTAMP | 最后更新时间 | 记录最后修改时间 |

**表说明**：实现电影与分类的多对多关系，一部电影可以属于多个分类，一个分类可以包含多部电影。

## 表关系总结

### 关系类型统计

| 关系类型 | 数量 | 说明 | 示例 |
|----------|------|------|------|
| 一对一关系 | 1 | 每个店铺有一个经理 | store ↔ staff(经理) |
| 一对多关系 | 18 | 主要业务关系 | customer → rental, film → inventory |
| 多对多关系 | 2 | 通过关联表实现 | film ↔ actor, film ↔ category |

### 外键关系统计

| 表名 | 外键数量 | 被引用次数 | 说明 |
|------|----------|------------|------|
| address | 1 | 4 | 被客户、员工、店铺引用 |
| film | 1 | 3 | 被库存、关联表引用 |
| store | 2 | 2 | 被客户、员工引用 |
| staff | 2 | 2 | 被店铺、租赁、支付引用 |
| customer | 2 | 2 | 被租赁、支付引用 |
| rental | 3 | 1 | 被支付引用 |
| country | 0 | 1 | 被城市引用 |
| city | 1 | 1 | 被地址引用 |
| language | 0 | 1 | 被电影引用 |
| category | 0 | 1 | 被关联表引用 |
| actor | 0 | 1 | 被关联表引用 |
| inventory | 2 | 1 | 被租赁引用 |
| payment | 3 | 0 | 不被其他表引用 |

## 数据量统计

| 表名 | 预估记录数 | 主要数据内容 | 增长趋势 |
|------|------------|--------------|----------|
| customer | 600+ | 客户基本信息 | 稳定增长 |
| staff | 2 | 员工信息 | 相对稳定 |
| actor | 200+ | 演员信息 | 缓慢增长 |
| film | 1000+ | 电影信息 | 定期增加 |
| category | 16 | 电影分类 | 基本稳定 |
| language | 6 | 语言信息 | 基本稳定 |
| store | 2 | 店铺信息 | 相对稳定 |
| inventory | 4581 | 库存记录 | 动态变化 |
| rental | 16044 | 租赁记录 | 快速增长 |
| payment | 14596 | 支付记录 | 快速增长 |
| address | 603 | 地址信息 | 缓慢增长 |
| city | 600 | 城市信息 | 基本稳定 |
| country | 109 | 国家信息 | 基本稳定 |
| film_actor | 5462 | 电影演员关联 | 随电影增长 |
| film_category | 1000+ | 电影分类关联 | 随电影增长 |

## 索引设计建议

### 主键索引（自动创建）
- 所有表的主键字段自动创建唯一索引

### 外键索引（建议创建）
- 所有外键字段创建索引以提高连接查询性能

### 业务查询索引（自定义）
- film.title：电影标题查询
- rental.rental_date：租赁日期查询
- customer.email：客户邮箱查询
- payment.amount：支付金额查询
- film.rating：电影评级查询
- actor.first_name：演员姓名查询

### 复合索引（多列组合）
- film(rating, rental_rate)：复合查询
- actor(first_name, last_name)：姓名查询
- rental(customer_id, rental_date)：客户租赁历史
- payment(customer_id, payment_date)：客户支付历史

---

*本文档详细描述了DVD租赁数据库的所有表结构，为数据库设计、开发和维护提供参考。*
